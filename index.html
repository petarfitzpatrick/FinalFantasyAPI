<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8" />
	<title>Character Searcher - FFXIV</title>
	<link rel="stylesheet" type="text/css" href="./css/style.css">
	<link href='https://fonts.googleapis.com/css?family=Hind|Montserrat:400,700' rel='stylesheet' type='text/css'>

	
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
	<script src="src/lodestoneapi.js"></script>
	
	
	<script type="text/javascript" src="https://www.google.com/jsapi"></script>
	
</head>
<body>
	<div id = "wrapper">
		
		<div id="header">
			<a id="headlink" href="./index.html">Character Searcher</a>
		</div>

		<div id = "navcontainer">
			<ul id = "navlist">
				<li><a href="./index.html" id="active">Home Page</a></li>
			</ul>
		</div>

		<div id="content">
			
		<img style="float:right;" src="./media/dalamud.png" alt="FFXIV Logo" width="200px"/>

			<article>
				<form id="character">
				<fieldset>
					<legend>Search Character:</legend>
					<input name="name" id="name" type="text" value="Zeno Nalno" placeholder="Character Name or ID">
					<select name="server" id="server">
						<option value="Adamantoise">Adamantoise</option>
						<option value="Aegis">Aegis</option>
						<option value="Alexander">Alexander</option>
						<option value="Anima">Anima</option>
						<option value="Asura">Asura</option>
						<option value="Atomos">Atomos</option>
						<option value="Bahamut">Bahamut</option>
						<option value="Balmung">Balmung</option>
						<option value="Behemoth">Behemoth</option>
						<option value="Belias">Belias</option>
						<option value="Brynhildr">Brynhildr</option>
						<option value="Cactuar">Cactuar</option>
						<option value="Carbuncle">Carbuncle</option>
						<option value="Cerberus">Cerberus</option>
						<option value="Chocobo">Chocobo</option>
						<option value="Coeurl">Coeurl</option>
						<option value="Diabolos">Diabolos</option>
						<option value="Durandal">Durandal</option>
						<option value="Excalibur">Excalibur</option>
						<option value="Exodus">Exodus</option>
						<option value="Faerie">Faerie</option>
						<option value="Famfrit">Famfrit</option>
						<option value="Fenrir">Fenrir</option>
						<option value="Garuda">Garuda</option>
						<option value="Gilgamesh">Gilgamesh</option>
						<option value="Goblin">Goblin</option>
						<option value="Gungnir">Gungnir</option>
						<option value="Hades">Hades</option>
						<option value="Hyperion">Hyperion</option>
						<option value="Ifrit">Ifrit</option>
						<option value="Ixion">Ixion</option>
						<option value="Jenova">Jenova</option>
						<option value="Kujata">Kujata</option>
						<option value="Lamia">Lamia</option>
						<option value="Leviathan">Leviathan</option>
						<option value="Lich">Lich</option>
						<option value="Malboro">Malboro</option>
						<option value="Mandragora">Mandragora</option>
						<option value="Masamune">Masamune</option>
						<option value="Mateus">Mateus</option>
						<option value="Midgardsormr">Midgardsormr</option>
						<option value="Moogle">Moogle</option>
						<option value="Odin">Odin</option>
						<option value="Pandaemonium">Pandaemonium</option>
						<option value="Phoenix">Phoenix</option>
						<option value="Ragnarok">Ragnarok</option>
						<option value="Ramuh">Ramuh</option>
						<option value="Ridill">Ridill</option>
						<option value="Sargatanas">Sargatanas</option>
						<option value="Shinryu">Shinryu</option>
						<option value="Shiva">Shiva</option>
						<option value="Siren">Siren</option>
						<option value="Tiamat">Tiamat</option>
						<option value="Titan">Titan</option>
						<option value="Tonberry">Tonberry</option>
						<option value="Typhon">Typhon</option>
						<option value="Ultima">Ultima</option>
						<option value="Ultros" selected>Ultros</option>
						<option value="Unicorn">Unicorn</option>
						<option value="Valefor">Valefor</option>
						<option value="Yojimbo">Yojimbo</option>
						<option value="Zalera">Zalera</option>
						<option value="Zeromus">Zeromus</option>
						<option value="Zodiark">Zodiark</option>
					</select>
					<input type="submit">
				</fieldset>
			</form>
			
			<div style="text-align:center; clear: both" id="data"></div>
				
			<div id="chart_div" style="display: block"></div>
			
			<div id="chart2_div" style="display: none"></div>
			
			<div id="chart3_div" style="display: none"></div>
			
			<div id="classInfo" style="display: none; height: 500px; font-size: 16px; background-color: white; padding: 1px 10px 0px 10px;"></div>
			
			<div id = "buttonwrapper" style = "margin-top: 2em; display: none">
				<div class="button" style="cursor:pointer; width: 20%; text-align: center" id="1" onclick="swap('chart_div', '1')">Disciple of War</div>
				<div class="button" style="cursor:pointer; width: 20%; text-align: center" id="2" onclick="swap('chart2_div', '2')">Disciple of Magic</div>
				<div class="button" style="cursor:pointer; width: 20%; text-align: center" id="3" onclick="swap('chart3_div', '3')">Heavensward Classes</div>
				<div class="button" style="cursor:pointer; width: 20%; text-align: center" id="4" onclick="swap('classInfo', '4')">Current Gear</div>
			</div>
			
			</article>
			
			<footer>
			
			</footer>
		</div>
			
	</div>

</body>
</html>
<script>
	
function swap(info, button) {
    document.getElementById('chart_div').style.display = 'none';
    document.getElementById('chart2_div').style.display = 'none';
    document.getElementById('chart3_div').style.display = 'none';
    document.getElementById('classInfo').style.display = 'none';
	
	document.getElementById('1').style.backgroundColor = '#363636';
    document.getElementById('2').style.backgroundColor = '#363636';
    document.getElementById('3').style.backgroundColor = '#363636';
    document.getElementById('4').style.backgroundColor = '#363636';
	
    document.getElementById(info).style.display = 'block';
    document.getElementById(button).style.backgroundColor = '#C2C2C2';
}
	
	
$(function drawBasic() {

    var $data = $('#data');
		$classInfo = $('#classInfo');

    // handle form submit
    $('form#character').on('submit', function(e)
    {	
        e.preventDefault();

        var name = $(this).find('#name').val().trim(),
            server = $(this).find('#server').val().trim();
		
		//Let user know that the system is working
        $data.text('Searching for: ' + name + ' on the server: ' + server);

        // Lodestone Search
		//API for Final Fantasy XIV the MMO - Documentation is on my Design Doc
        LodestoneAPI.Search.Character(name, server, function(Character)
        {
            if (Character)
            {
                console.log('Found:', Character);
				//We found the character
				//Initialize UI
				document.getElementById('buttonwrapper').style.display = 'block';
				swap('chart_div', '1');

                // print data
				//First clear any past data
                $data.empty();
                $data.append('<h2>' + Character.name +' - '+ Character.activeJob +'</h2><br>');
				$data.append('<img style="text-align:center;" src=' +Character.portrait + '><br>');
				$data.append('<p>Free Company: ' + Character.freeCompany + '<p>');
				$data.append('<p>Race: ' + Character.race + ' - ' + Character.clan + '<p><br>');

				//CHART 1 DATA
				//This is using google's charts API
				var data = new google.visualization.DataTable();
				data.addColumn('string', 'Class');
				data.addColumn('number', 'Class Level');
			
				data.addRows([
					[Character.classjobs[0].name, Number(Character.classjobs[0].level)],
					[Character.classjobs[1].name, Number(Character.classjobs[1].level)],
					[Character.classjobs[2].name, Number(Character.classjobs[2].level)],
					[Character.classjobs[3].name, Number(Character.classjobs[3].level)],
					[Character.classjobs[4].name, Number(Character.classjobs[4].level)],
					[Character.classjobs[5].name, Number(Character.classjobs[5].level)],
				]);
			
				//CHART 1 OPTIONS
				var options = {
					colors: ['#9f2637'],
					height: 500,
					width: 1100,
					title: 'Class Level for Disciple of War',
					textStyle:{
						fontSize: 10
					},
					hAxis: {
					title: 'Class',
					viewWindow: {
						min: [7, 30, 0],
						max: [17, 30, 0]
					}
					},
					vAxis: {
					title: 'Class Level',
					viewWindow: {
						max: 60
					}
					}
				};
				
				//CHART 2 DATA
				var data2 = new google.visualization.DataTable();
				data2.addColumn('string', 'Class');
				data2.addColumn('number', 'Class Level');
			
				data2.addRows([
					[Character.classjobs[6].name, Number(Character.classjobs[6].level)],
					[Character.classjobs[7].name, Number(Character.classjobs[7].level)],
					[Character.classjobs[8].name, Number(Character.classjobs[8].level)],
				]);
			
				//CHART 2 OPTIONS
				var options2 = {
					colors: ['#9f2637'],
					height: 500,
					width: 1100,
					title: 'Class Level for Disciple of Magic',
					textStyle:{
						fontSize: 10
					},
					hAxis: {
					title: 'Class',
					viewWindow: {
						min: [7, 30, 0],
						max: [17, 30, 0]
					}
					},
					vAxis: {
					title: 'Class Level',
					viewWindow: {
						max: 60
					}
					}
				};
				
				//CHART 3 DATA
				var data3 = new google.visualization.DataTable();
				data3.addColumn('string', 'Class');
				data3.addColumn('number', 'Class Level');
			
				data3.addRows([
					[Character.classjobs[9].name, Number(Character.classjobs[9].level)],
					[Character.classjobs[10].name, Number(Character.classjobs[10].level)],
					[Character.classjobs[11].name, Number(Character.classjobs[11].level)],
				]);
			
				//CHART 3 OPTIONS
				var options3 = {
					colors: ['#9f2637'],
					height: 500,
					width: 1100,
					title: 'Class Level for Heavensward Classes',
					textStyle:{
						fontSize: 10
					},
					hAxis: {
					title: 'Class',
					viewWindow: {
						min: [7, 30, 0],
						max: [17, 30, 0]
					}
					},
					vAxis: {
					title: 'Class Level',
					viewWindow: {
						max: 60
					}
					}
				};
			
				var chart = new google.visualization.ColumnChart(
					document.getElementById('chart_div'));
				chart.draw(data, options);
				
				var chart2 = new google.visualization.ColumnChart(
					document.getElementById('chart2_div'));
				chart2.draw(data2, options2);
				
				var chart3 = new google.visualization.ColumnChart(
					document.getElementById('chart3_div'));
				chart3.draw(data3, options3);
			
				//Gear info
				for(var i in Character.gear)
                {
                    var set = Character.gear[i].gear,
                        ilv = Character.gear[i].gearStats.average,
                        g = i.split('-'),
                        c = g[0].toUpperCase(),
                        j = (typeof g[1] == 'undefined') ? '' : g[1].toUpperCase();

                    // gear title
                    $classInfo.append('<h1>Gear for: '+ c +' + '+ j +'<br>  Item Level: '+ ilv +'</h1><br>');
                    for(var j in set)
                    {
                        g = set[j];
                        $classInfo.append('		('+ g.slot +') '+ g.name +'<br>');
                    }
                    $classInfo.append('<br>');
					break;
					//We only want ACTIVE gear
					//Anything we would loop through after is obsolete
                }
				// fin
				return;
            }
			//Let User know what's going on
            $data.html('Could not find character. Try again.');
        });
    });
});

//Info for Google Charts
google.load('visualization', '1', {packages: ['corechart', 'bar']});
google.setOnLoadCallback();
</script>
